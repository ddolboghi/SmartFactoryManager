{% extends 'fixed.html' %}
{% block content %}
<!-- <form class="form-signin card mb-6" method="post" enctype="multipart/form-data">
  <h1 class="h3 mb-3 font-weight-bold">Please upload a picture of the car door!</h1>
  <input type="file" name="file" class="form-control-file" id="inputfile">
  <div class="mt-2"></div>
  <button type="button" id="uploadButton">
    <span class="box">
      Upload!
    </span>
  </button>
  <p class="mt-5 mb-3 text-muted custom-text">
    자동차 문의 이미지를 업로드 할 경우, <br>
    표면에 있는 스크래치, 외관손상 불량을 탐지합니다.
  </p>
  
</form> -->

<div class="container">
  <form class="form-signin card mb-6 mt-5" method="post" enctype="multipart/form-data">
      <h1 class="h3 mb-3 font-weight-bold text-center">자동차 도어 사진을 업로드해주세요.</h1>
      <input type="file" name="file" class="form-control-file" id="inputfile" onchange="previewImage(this);">
      <div class="mt-2"></div>
      <button type="button" id="uploadButton" class="btn btn-primary">
          <span class="box">
              검사하기
          </span>
      </button>
      <p class="mt-5 mb-3 text-muted custom-text text-center">
          자동차 문의 이미지를 업로드 할 경우, <br>
          표면에 있는 스크래치, 외관손상 불량을 탐지합니다.
      </p>
  </form>
  <img id="imagePreview" src="#" alt="Car door image" class="img-fluid rounded mx-auto d-none">
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script type="text/javascript">
  $(document).ready(function() {
    $('#inputfile').bind('change', function () {
      let fileSize = this.files[0].size / 1024 / 1024; // this gives in MB
      if (fileSize > 1) {
        $("#inputfile").val(null);
        alert('file is too big. images more than 1MB are not allowed')
        return;
      }

      let ext = $('#inputfile').val().split('.').pop().toLowerCase();
      if ($.inArray(ext, ['jpg', 'jpeg', 'png']) == -1) {
        $("#inputfile").val(null);
        alert('only jpeg/jpg/png files are allowed!');
      }
    });

    $('#uploadButton').on('click', function() {
      if ($("#inputfile").get(0).files.length === 0) {
        alert("먼저 이미지를 선택해주세요.");
      } else {
        // Submit the form here if a file is selected.
        $(".form-signin").submit();
      }
    });
  });
</script>
{% endblock content %}
